# Gradle 

Gradle is one of the most popular build tools for java.

Comparison between build tools: https://technologyconversations.com/2014/06/18/build-tools/ 

## Starting a project

One possible way to initialize a gradle project would be via the command:

```g
gradle init --type java-library
```

1. Simple example

Create the project by defining a `build.gradle` file. This one will only apply the java plugin (which does a fair amount of tasks). 

Then, create the `./src/main/java/` directory, with the `SomeClass` class. The project can be generated by executing the following command from the build directory:

```
gradle clean build
```

This generates the project. `libs` contains the jar archive of the project and `classes` contains the generated class. The generated class can be with the following command from the `./build/classes/` directory:

```
java SomeClass
```

The resulting jar file is not executable and only has the `Manifest-Version` attribute in the manifest. But the code can still be executed if the jar file is specified in the classpath, since it's loaded by the Class Loader:

```
java -cp .../build/libs/01.jar SomeClass
```

2. Same example with executable jar

This can be done if the project doesn't have any external jar dependencies. The following line has to be added to the `build.gradle` file:

```
jar { manifest { attributes 'Main-Class': 'SomeClass'  }   }
```

This adds the `Main-Class` attribute to the generated manifest file of the jar archive. The archive can then be executed via:

```
java -jar build/libs/02.jar
```

3. Sample example with dependencies from maven repository.

In this example, the `Hw.java` files depends on log4j, but this time the jar archive is not on the file system. The dependency is specified in this case in the `build.gradle` file, is an implementation (both compile and runtime) dependency and taken from a public maven repository.

This project also contains the log4j configuration in the `src/resources` directory.

The entire project can be compiled using

```
gradle clean build
```

which generates a fatjar including the log4j dependency.

The Hw.class code is the generated bytecode in the `build/classes/` directory, and the generated jar archive is at `build/libs/03.jar`. The manifest contains `Hw` as the main class, and the archive has the compiled byte code of the class as well as the log4j compiled dependencies.

The project can be executed without having to specify any dependency:

```
java -jar build/libs/03.jar
```

4. Binary distribution

This is the same example as the one above, with the log4j dependency, except that gradle will also create binaries that can be executed on Windows and Linux. For this, gradle requires the `application` plugin:

```
apply plugin: application
```

The build step is identical:

```
gradle clean build
```

This still creates the jar archive (which is not executable), but it also creates two more archives under distributions (one for Windows and one for Unix). Both archives contain a lib directory where the Hw jar (without the log4j) and the log4j jar are located. They also contain a bin directory, which has two scripts (a shell and a batch one) that can be executed from the bin directory to run the application.
